<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<meta name="format-detection"content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<title>再见</title>
<link rel="stylesheet" href="css/ks.css">
<link rel="stylesheet" href="css/stylesy.css">
<link rel="stylesheet" href="css/animate.css">
</head>  
<body>
<div class="wp">
    <div class="m-music" id="j-music"></div>

    <div id="j-flipbook" class="wp-inner flipbook">
         <!-- ======= 1 ====== -->
        <div class="page1 page clt_in">
            <div class="m-lumpl m-ui"></div>
            <div class="m-lumpr m-ui"></div>
            <p class="m-text">我是第<strong class="j-numRest" id="j-p1NumRise" data-num="345456" data-type="big">0</strong>个<br>加入盒子学园的盒饭</p>
            <div class="m-bot">
                <div class="m-stage m-ui"></div>
                <div class="m-box m-ui">
                    <img src="images/head.jpg" alt="头像">
                </div>
            </div>
            <div class="m-flower m-ui"></div>
        </div>

        <!-- ======= 2 ====== -->
        <div class="page2 page clt_out">
            <div class="m-masker animated"></div>
            <div class="m-titler m-ui animated">入学时间</div>
            <div class="m-calendar m-ui animated">
                <p class="m-tl">2014年12月
                <strong class="j-p2NumRise1 j-numRest" data-num="31">0</strong>
                日</p>
                <p class="m-tr">已经
                <strong class="j-p2NumRise2 j-numRest" data-num="32">0</strong>
                天</p>
            </div>
            <!-- 星星 -->
            <p class="m-startiti animated">（盒子资历）</p>
            <ul class="m-starww">
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
            </ul>
        </div> 

        <!-- ======= 3 ====== -->
        <div class="page3 page clt_out">
            <!-- 没有数据
            <div class="m-nodata animated">
                <p class="m-titi">第一课：游戏达人课</p>
                <p>游戏千千万，<br>我(他)竟然没下过一款？<br>这绝逼不科学</p>
            </div>
            -->
            <!-- 有数据  -->
            <div class="m-masker animated"></div>
            <div class="m-title m-ui animated">第一课：游戏达人课</div>
            <div class="m-info">
                <div class="m-rb m-ui animated"></div>
                <div class="m-rs m-ui animated"></div>
                <div class="m-t1 m-ui animated">
                    <p>植物大战僵尸全明星<br>玩过<strong>145</strong>次</p>
                </div>
                <div class="m-t2 m-ui animated">
                    <p>玩过<strong>145</strong>个</p>
                </div>
            </div>
            <p class="m-startiti animated">（游戏资历）</p>
            <ul class="m-starww">
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
            </ul>
           
        </div>


        <!-- ======= 4 ====== -->
        <div class="page4 page clt_out">
            <!-- 没有数据
            <div class="m-nodata animated">
                <p>奇葩、搞笑，啥都有！<br> 没加入过圈子？ <br>弱爆了！</p>
            </div>
            -->
            <!-- 有数据 -->
            <div class="m-masker animated"></div>
            <div class="m-title m-ui animated">第二课：扎堆聊天课</div>
            <ul class="m-info">
                <li>
                    <div class="m-post m-post1 animated" style="height: 100%;">
                        <p class="m-tum"><span>7</span>个</p>
                        <p class="m-name"><span>我的</span>兴趣圈</p>
                    </div>
                </li>
                <li>
                   
                   <div class="m-post m-post2 animated" style="height: 40%;">
                        <p class="m-tum"><span>0</span>个</p>
                        <p class="m-name"><span>我的</span>游戏圈</p>
                    </div>
                </li>
            </ul>
            <p class="m-text animated">第一次玩的圈子：<span>休闲娱乐圈</span></p>

            <p class="m-startiti animated">（圈子资历）</p>
            <ul class="m-starww">
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
            </ul>
        </div>

        <!-- ======= 5 ====== -->
        <div class="page5 page clt_out">
            <!-- 没有数据
            <div class="m-nodata animated">
                <p>动动小手<br>发发动态， <br>记录（你的）日常点滴</p>
            </div>
            -->
            <!-- 有数据 -->
            <div class="m-masker animated"></div>
            <div class="m-title m-ui animated">第三课：写小纸条课</div>
            <div class="m-phone m-ui animated">
                <p class="animated"><span>我的动态</span><br><strong id="j-p5NumRise" class="j-numRest" data-num="256">0</strong>条</p>
            </div>
            <p class="m-text animated">第一次发表动态：<span>2014年11月8日</span></p>
            <p class="m-startiti animated">（话唠程度）</p>
            <ul class="m-starww">
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
            </ul>
        </div>

        <!-- ======= 6 ====== -->
        <div class="page6 page clt_out">
            <!-- 没有数据
            <div class="m-nodata animated">
                <p>
                    赚盒币好处多多！ <br>游币、Q币、话费想换就换<br>
                    <a href="javascript:;">到游戏盒【我-兑换】里好礼多多！</a>
                </p>
            </div>
            -->
            <!-- 有数据 -->
            <div class="m-masker animated"></div>
            <div class="m-title m-ui animated">第四课：大富翁养成课</div>
            <div class="m-infott">
                <i class="m-ui animated"></i>
                <p class="animated">
                    <strong>×805个</strong>
                    （我的盒币）<br>
                    <span>已兑公仔/话费/Q币</span>
                </p>
            </div>
            <div class="m-chart animated" id="j-p6chart"></div>
            <div class="m-cavchart"><canvas id="jp6Chart"></canvas></div>
            <p class="m-chartText animated">
                <span>我打败</span>
                <strong class="j-numRest" id="j-p6NumRise" data-num="85">0</strong>
                <strong>%</strong>好友
            </p>
            <p class="m-startiti animated">（吸金能力）</p>
            <ul class="m-starww">
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
            </ul>
        </div>

        <!-- ======= 7 ====== -->
        <div class="page7 page clt_out">
            <!-- 没有数据
            <div class="m-yg m-ui">
                <div class="m-cjl m-ui">
                </div>
                <div class="m-man m-ui"></div>
                <div class="m-mostar m-ui"></div>
            </div>
            <div class="m-nodata animated">
                <p>
                    不做孤“单”英雄，<br>
                    马上加入<a href="javascript:;">家族</a>，<br>
                    与小伙伴一起
                </p>
            </div>
            -->
            <!-- 有数据 -->
            <div class="m-masker animated"></div>
            <div class="m-title m-ui animated">第五课：拉帮结派课</div>
            <div class="m-yg m-ui">
                <div class="m-cjl m-ui">
                    <p class="m-txt animated"><span>我加入</span>COC大乱斗家族</p>
                    <div class="m-dfdfer m-ui animated"></div>
                </div>
                <div class="m-man m-ui"></div>
                <div class="m-mostar m-ui"></div>
                <ul class="m-starww">
                    <li class="m-ui animated"></li>
                    <li class="m-ui animated"></li>
                    <li class="m-ui animated"></li>
                </ul>
            </div>
        </div>

        <!-- ======= 8 ====== -->
        <div class="page8 page clt_out">
            <!-- 没有数据
            <div class="m-nodata animated">
                <p>
                    游戏盒混了许久，有谁陪在身边？ <br>他(我)注定是个英雄，需要有人追随！<br> 
                    <a href="javascript:;">没有好友怎么行</a>
                </p>
            </div>
            -->
            <!-- 有数据 -->
            <div class="m-masker animated"></div>
            <div class="m-title m-ui animated">第六课：交个朋友课</div>
            <div class="m-chart animated"></div>
            <div class="m-cavchart animated"><canvas id="j-p8Chart" data-end="35"></canvas></div>
            <div class="m-chartText">
                <p class="m-ct1 animated">我的<br><span>粉丝</span></p>
                <p class="m-ct2 animated">我已<br><span>关注</span></p>
            </div>
            <div class="m-t1 m-ui animated">
                <p>我的粉丝人数<br><strong data-num="656" class="j-p8NumRise1">0</strong>个</p>
            </div>
            <div class="m-t2 m-ui animated">
                <p>我已关注的人数<br><strong data-num="325" class="j-p8NumRise2">0</strong>个</p>
            </div>
            <div class="m-t3 m-ui animated">
                <p>第一个关注的是<br><strong><a href="javascript:;">马里奥</a></strong></p>
            </div>
            <p class="m-startiti animated">（好友指数）</p>
            <ul class="m-starww">
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
                <li class="m-ui animated"></li>
            </ul>
        </div>

        <!-- ======= 9 ====== -->
        <div class="page9 page clt_out">
            <div class="m-bg m-ui">
                
                
                <!-- 游戏盒打开 -->
                <div class="m-sec1">
                    <p class="m-score"><strong>95</strong>分</p>
                    <i class="m-level ap"></i> 
                    <dl class="m-scmore">
                        <dt>游戏资历：</dt>
                        <dd class="s1"></dd>  
                        <dt>吸金能力：</dt>
                        <dd class="s2"></dd>
                        <dt>基友指数：</dt>
                        <dd class="s3"></dd>
                    </dl>
                </div>
                <div class="m-btn m-btn1">
                    <p>学习了这么多游戏盒知识，分享给好友看看</p>
                    <a class="m-ui" href="javascript:;">晒成绩单</a>
                </div>
                
                <!-- 其他人打开
                <div class="m-sec2">
                    <p class="m-text">“我是小姑娘”的成绩是</p>
                    <p class="m-score"><strong>95</strong>分</p>
                    <i class="m-level ap"></i> 
                </div>
                <div class="m-btn m-btn2">
                    <p>下载游戏盒，查看我的成绩单~</p>
                    <a class="m-ui m-down" href="###">下载游戏盒</a>    --><!--外部打开 --> <!--
                    <a class="m-ui m-lkmy" href="###">查看我的成绩单</a>   --><!--游戏盒内打开--><!--
                    <p>玩游戏盒，你还可以：<span>赚钱 游戏 交友</span><br><span>（赚游币、Q币、话费)</span></p>
                </div>
                -->
            </div>
        </div>
    </div>

    <span class="arrow" id="j-arrow"></span>
</div>
<script src="js/zepto.min.js"></script>
<script src="js/zepto.fullpage.js"></script>
<script src="js/music.js"></script>
<script type="text/javascript">

var Twoapp = function(){
    var obj = this;
    var $flipbook = $('#j-flipbook');
    var chartSize = $('#j-p6chart').width();

    this.init = function(){
        this.book();
        obj.controlled_number_rnu('#j-p1NumRise');
      
        Resource.addSound("Sugar", "images/bg.mp3",1, .5);
        $("#j-music").on("click", function(){
            if(obj.is_music_play){
                obj.is_music_play = false;
                $(this).removeClass("on").addClass("off");
                Resource.pauseSound("Sugar");
            } else {
                obj.is_music_play = true;
                $(this).removeClass("off").addClass("on");
                Resource.playSound("Sugar", 1);
            }
        });
    };
    this.book = function(){
        $flipbook.fullpage({
            beforeChange: function (e) {
                if(e.next == 8){
                    $('#j-arrow').hide();
                }else{
                    $('#j-arrow').show();
                }
            },
            afterChange: function(e){
                $('.page').eq(e.cur).addClass('clt_in').removeClass('clt_out').siblings().addClass('clt_out').removeClass('clt_in');
                obj.switchPage(e.cur);
            }
        });
        $('#j-arrow').on('click',function(){
            $.fn.fullpage.moveNext(true);
        });
        
    };
    this.switchPage = function(page){
            console.log(page);
            switch(page){
                case 0:
                    obj.controlled_number_rnu('#j-p1NumRise');
                    break;
                case 1:
                    obj.controlled_number_rnu('.j-p2NumRise1',500);
                    obj.controlled_number_rnu('.j-p2NumRise2',500);
                    break;
                case 4:
                    obj.controlled_number_rnu('#j-p5NumRise',600);
                    break;
                case 5:
                    setTimeout(function(){
                        obj.drawRround('jp6Chart',0,$('#j-p6NumRise').attr('data-num'),chartSize,chartSize,'#55c691');
                    },800);
                    obj.controlled_number_rnu('#j-p6NumRise',800,50);
                    break;
                case 6:
                    if( !$('#j-p8Chart').attr('isDraw') ){
                        obj.drawRround('j-p8Chart',0,$('#j-p8Chart').attr('data-end'),chartSize,chartSize,'#b872f7','#b872f7');
                        $('#j-p8Chart').attr('isDraw','1');
                    }
                    break;
                case 7:
                    obj.controlled_number_rnu('.j-p8NumRise1',1200);
                    obj.controlled_number_rnu('.j-p8NumRise2',2000);
                    break;
            }
            obj.pageReset(page);
    
    };
    this.big_number_rise = function(start, end, element,delay,diff) {
        delay = parseInt(delay) || 60;
        diff = parseInt(diff) || 1;

        element.html(Math.round(start));
        setTimeout(function() {
            delay = Math.max(5, delay / 2);
            diff += 100;
            if (start == end) {
                return;
            };
            if (start + diff > end) {
                diff = end - start;
            };
            obj.big_number_rise(start + diff, end, element, delay, diff);
        }, delay);
    };
    this.small_number_rise = function(start, end, element, delay) {
        var clr = null;
        var rand = start;
        var dist = 1;
        if(end > 30){
            dist = Math.round((end - start)/30);
        }
        function loop() {
            clearTimeout(clr);
            function inloop() {
                element.html(rand += dist);
                if (!(rand < end)) {
                    element.html(end);
                    return;
                }
                clr = setTimeout(inloop, (delay || 30));
            };
            inloop();
        };
        loop();
    };
    this.controlled_number_rnu = function(ele,time,delay){
        time = time || 0;
        setTimeout(function(){
            if($(ele).attr('data-type') == 'big'){
                obj.big_number_rise(0, $(ele).attr('data-num'), $(ele),delay);
            }else{
                obj.small_number_rise(0, $(ele).attr('data-num'), $(ele),delay);
            }
        },time);
    };
    this.pageReset = function(page){
        $('.clt_out .j-numRest').each(function(index,ele){
            $(ele).html('0');
        });
        if(page != 5 && obj.jp6Chart_ctx){
            obj.jp6Chart_ctx.clearRect(0,0,chartSize,chartSize);
            clearInterval(obj.jp6Chart_Interval);
        }
    };
    this.drawRround = function(id,start,end,width,height,color1,color2){
        var nowAngle=0,
            start=+start || 0,
            end=+end || 0,
            canvas=document.getElementById(id);

        if(!canvas){
            return;
        }  
            
        var ctx=canvas.getContext("2d"),
            radius = width/2;

        canvas.width = width;
        canvas.height = height;

        end=end>=100?100:end;
        end=end<=0?0:end;

        obj[id+'_Interval']=setInterval(drawC,2),
        obj[id+'_ctx'] = ctx;

        ctx.fillStyle= color1 || "#1A5FC5";
        ctx.strokeStyle= color2 || 'rgba(0,0,0,0.1)';
        ctx.lineWidth=1;
        ctx.clearRect(0,0,width,height);
        
        function drawC(){
            ctx.beginPath();
            ctx.moveTo(radius,radius);
            ctx.arc(radius,radius,radius,0,start+Math.PI*2/360);
            start+=Math.PI*2/360;
            if(start>Math.PI*2*end/100){
                clearInterval(obj[id+'_Interval']);
            }
            ctx.fill();
            ctx.stroke();
        }
    };
};
$(function(){
    (new Twoapp).init();
});
</script>
</body>
</html>